# DB 기본

## 트랜잭션


### 트랜잭션

* 인가받지 않은 사용자로부터 데이터를 보장하기 위해 DBMS 가 가져야 하는 특성
* DB 시스템에서 하나의 논리적 기능을 정상적으로 수행하기 위한 작업의 기본 단위
1. 특성
	1. Atomicity
		1. commit / rollback
		2.  회복성 보장
	2. Consistency
		1.  무결성 제약조건
		2.  동시성 제어
		3. 병행 제어
			1. Locking
				1. Mutual Exclusion
				2. 로킹 단위
					1. 공유도 & 오버헤드
			2. optimistic validation
			3. time stamp ordering
			4. MVCC
			5. 2PC
	3. Isolation
		1. 고립화 수준
			1. 하나의 트랜잭션이 현재의 데이터에 대한 무결성을 해치지 않도록, 잠금을 설정하는 정도
	4. Durability
		1. 회복 기법
			1. 트랜잭션을 수행하는 도중, 장애로 인해 손생된 데이터베이스를 손상되기 이전의 정상적인 상태로 복구시키는 작업
			2. 요소
				1. REDO
				2. UNDO
			3. 종류
				1. 로그 기반 회복 기법
					1. deferred
					2. immediate
				2. checkpoint recovery
				3. shadow paging recovery
2. 상태
	1. ACTIVE
	2. Partially committed
	3. committed
	4. failed
	5. aborted
3. 트랜잭션 제어 언어 (TCL)
	1. COMMIT
	2. ROLLBACK
	3. CHECKPOINT


### DDL



1. DDL 의 대상
	1. 스키마
		1. DB 구조, 제약조건 등의 정보를 담고 있는 기본구조
		2. 구성
			1. external (sub schema)
				1. 사용자 관점에서의 니즈
			2. conceptual
				1. DB의 논리적 구조 (관계, constraint, 무결성, 보안 등)
			3. internal
				1. 물리적 구조, 레코드의 물리적 순서
	2. TABLE
		1. = 릴레이션, 엔티티
		2. 관련 용어
			1. tuple / row
			2. attribute / column
			3. cardinality
			4. degree
			5. domain
	3. VIEW
		1. 장점
			1. 논리적 독립성 제공
			2. 데이터 조작연산 간소화
			3. 보안 기능 (접근제어) 제공
		2. 단점
			1. 뷰 자체 인덱스 불가
			2. 뷰 변경 불가
			3. 데이터 변경 제약 존재
	4. INDEX
		1. 검색 연산 최적화를 위해, DB 내 값에 대한 주소 정보로 구성된 데이터 구조
		2. PK 컬럼은 자동으로 인덱스
	* DB 파일 구조
		* 순차 방법
		* 인덱스 방법
			* 인덱스 생성시 이것이 됨
		* 해싱 방법
2. DDL 명령어
	1. CREATE
	2. ALTER
	3. DROP
	4. TRUNCATE
3. TABLE 관련 DDL
	1. CREATE TABLE
		1. PRIMARY KEY
		2. FOREIGN KEY
		3. UNIQUE
		4. NOT NULL
		5. CHECK
		6. DEFAULT
	2. ALTER TABLE
		1. ALTER TABLE ADD
		2. ALTER TABLE ALTER
		3. ALTER TABLE DROP COLUMN
	3. DROP TABLE
		1. CASCADE
		2. RESTRICT
	4. TRUNCATE TABLE
4. VIEW 관련 DDL
	1. CREATE VIEW AS
	2. CREATE OR REPLACE VIEW AS
	3. DROP VIEW
5. CREATE INDEX
	1. CREATE [UNIQUE] INDEX ON
	2. ALTER INDEX ON
	3. DROP INDEX


### DML

1. 종류
	1. SELECT
	2. INSERT
	3. UPDATE
	4. DELETE
2. SELECT
3. WHERE
4. LIKE
	1. %
	2. [ ]
	3. [^]
	4. _
5. DELETE

### DML 상세

* 가장 대표적인 데이터 연결 방법

1. JOIN
	1. 종류
		1. cross
		2. theta
		3. equi, inner
		4. natural
		5. outer
			1. left / right / outer
		6. semi
		7. self
2. 서브쿼리
	1. 종류
		1. FROM절
			1. 인라인뷰
		2. WHERE절
			1. nested 서브쿼리
3. set operator
	1. union
	2. union all
	3. intersect
	4. minus


### DCL


1. 개념
	1. GRANT
		1. `GRANT 권한 ON TABLE TO 사용자`
	2. REVOKE
		1. `REVOKE 권한 ON TABLE FROM 사용자`



# 응용 SQL


## 집계성 SQL


### Multiple Row Operator

1. 다중 행 연산자
	1. 종류
		1. IN
		2. ANY
		3. ALL
		4. EXISTS

```SQL
SELECT *
FROM TBL A
WHERE SALARY > ANY(SELECT SALARY FROM TBL WHERE JOB="과장")
WHERE SALARY > ALL(SELECT SALARY FROM TBL WHERE JOB="과장")
WHERE SALARY > EXISTS (SELECT 1 FROM TBL B WHERE A.SALARY=B.SALARY)
```


2. AGGREGATE 집계함수
	1. GROUP BY
	2. HAVING
	3. COUNT
	4. SUM
	5. AVG
	6. MAX
	7. MIN
	8. STDDEV
	9. VARIANCE